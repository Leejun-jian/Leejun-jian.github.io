<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="环境准备 vscode、  cvm腾讯云服务器、  git、gcc&#x2F;gdb、  cloc(统计代码量)  docker   cmake  apt install git  apt install cloc   下载相应的文件需要进入管理员模式，非管理员模式需要sudo apt install apt update&#x2F;apt upgrade   先升级包管理器，然后再下载 apt">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2023/08/29/Linux%E9%A1%B9%E7%9B%AE-lsc/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="环境准备 vscode、  cvm腾讯云服务器、  git、gcc&#x2F;gdb、  cloc(统计代码量)  docker   cmake  apt install git  apt install cloc   下载相应的文件需要进入管理员模式，非管理员模式需要sudo apt install apt update&#x2F;apt upgrade   先升级包管理器，然后再下载 apt">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220727141832746.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114219485.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114229570.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114246518.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114304332.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220727171110991.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114545229.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114649118.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114719567.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114737764.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728191315255.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729134439464.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728194756012.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729135125765.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729171429467.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729180823959.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729181027754.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729183806790.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729184111289.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730131847723.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730132210416.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730132738608.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730133009527.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730133120133.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730172546525.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220803152716787.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220802142150145.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220804115232333.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220804125113601.png">
<meta property="article:published_time" content="2023-08-29T13:11:36.617Z">
<meta property="article:modified_time" content="2022-08-04T04:51:17.238Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220727141832746.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Linux项目-lsc" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/29/Linux%E9%A1%B9%E7%9B%AE-lsc/" class="article-date">
  <time class="dt-published" datetime="2023-08-29T13:11:36.617Z" itemprop="datePublished">2023-08-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><ul>
<li><p>vscode、</p>
</li>
<li><p>cvm腾讯云服务器、</p>
</li>
<li><p>git、gcc&#x2F;gdb、</p>
</li>
<li><p>cloc(统计代码量)</p>
</li>
<li><p>docker </p>
</li>
<li><p>cmake</p>
</li>
<li><p>apt install git</p>
</li>
<li><p>apt install cloc</p>
</li>
</ul>
<p>下载相应的文件需要进入管理员模式，非管理员模式需要sudo apt install</p>
<p>apt update&#x2F;apt upgrade   先升级包管理器，然后再下载</p>
<p>apt get install</p>
<ul>
<li><p>git init 初始化git仓库</p>
</li>
<li><p>git add filename从工作区加到暂存器</p>
</li>
<li><p>git commit filename -m “描述信息” 从暂存区添加到本地版本库</p>
</li>
<li><p>git status 查看版本状态</p>
</li>
<li><p>git log 查看日志信息</p>
<p>关联本地仓库和远程仓库</p>
<p>git remote  add myremote git@”ssh地址”连接远程仓库</p>
<p>git remote -v 查看远程仓库信息</p>
<p><strong>交代码之前先拉代码</strong></p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220727141832746.png" alt="image-20220727141832746"></p>
<p>git pull&#x2F;fetch myremote “分支名”(fetch拉的是变更的代码，pull拉的是远程分支所有的代码)</p>
<p>git branch -r&#x2F;-a 查看远程分支</p>
<p><strong>git配置</strong></p>
</li>
<li><p>git config –global user.name “名字”</p>
</li>
<li><p>git config –global user.email “邮箱”</p>
</li>
<li><p>git checkout -b ”master“  创建新的分支，分支名最好和远程仓库一样</p>
<p><strong>推拉之前需要先搞秘钥</strong>：</p>
</li>
<li><p><strong>ssh-keygen -t rsa -C “邮箱地址” 生成秘钥</strong></p>
</li>
<li><p>生成秘钥之后，在家目录中有一个 ~&#x2F;**.ssh&#x2F;ssh_rsa.pub **文件里面有我们生成的公钥和私钥</p>
</li>
<li><p>拷贝公钥—-》进入git到创建的项目里面添加公钥</p>
</li>
</ul>
<p>推代码：</p>
<p>建立远程连接：git remote add origin <a href="mailto:&#x67;&#x69;&#x74;&#x40;&#103;&#105;&#x74;&#x65;&#101;&#46;&#x63;&#111;&#109;">&#x67;&#x69;&#x74;&#x40;&#103;&#105;&#x74;&#x65;&#101;&#46;&#x63;&#111;&#109;</a>:shijiu2xin&#x2F;dsf.git<br>推代码： git push -u origin “master”</p>
<h3 id="数据库MySQL"><a href="#数据库MySQL" class="headerlink" title="数据库MySQL"></a>数据库MySQL</h3><p>安装命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install mysql-client-core-8.0</span><br><span class="line">sudo apt-get install libmysqlclient-dev -y</span><br></pre></td></tr></table></figure>

<p>数据库的相关命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl start mariadb  <span class="comment">#启动MariaDB</span></span><br><span class="line">systemctl stop mariadb  <span class="comment">#停止MariaDB</span></span><br><span class="line">systemctl restart mariadb  <span class="comment">#重启MariaDB</span></span><br><span class="line">systemctl <span class="built_in">enable</span> mariadb  <span class="comment">#设置开机启动</span></span><br></pre></td></tr></table></figure>

<p>mysql创建完成之后默认的用户密码为空，可以通过以下命令改变root用户密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqladmin -u root password &quot;new_password&quot;;</span><br></pre></td></tr></table></figure>



<h2 id="vscode链接云服务器"><a href="#vscode链接云服务器" class="headerlink" title="vscode链接云服务器"></a>vscode链接云服务器</h2><p>进入vscode打开拓展</p>
<ul>
<li><p>下载remote-ssh 插件</p>
</li>
<li><p>点击远程资源管理器，添加远程资源</p>
<p>查看端口 lsof -i :22</p>
<p> cd &#x2F;etc&#x2F;ssh&#x2F;config   查看相关文件</p>
<p>service ssh restart  启动ssh远程服务</p>
<p>systemctl restart ssh 启动ssh远程服务</p>
</li>
</ul>
<h3 id="cmake的使用"><a href="#cmake的使用" class="headerlink" title="cmake的使用"></a>cmake<strong>的使用</strong></h3><p>编译构建工具，用来编译构建大型的软件程序</p>
<ul>
<li><p>CMakeLists.txt(注意大小写)</p>
<p><strong>基本语法</strong>：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.0</span>.<span class="number">0</span>）</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span>(项目名称)</span><br><span class="line"><span class="comment">#设置环境变量</span></span><br><span class="line"><span class="keyword">set</span> (CMAKE_CXX&lt;FLAGS <span class="variable">$&#123;CMAKE_CXX&lt;FLAGS&#125;</span> -g)</span><br><span class="line"><span class="comment">#EXECUTABLE_OUTPUT_PATH生成的在可执行文件的存储路径</span></span><br><span class="line"><span class="comment">#EXECUTABLE_OUTPUT_PATH项目的根目录</span></span><br><span class="line"><span class="comment">#include_dirrctories添加头文件地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置可执行文件的输出路径</span></span><br><span class="line"><span class="keyword">set</span> (EXECUTABLE_OUTPUT_PATH <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/bin)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">include_dirrctories(<span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/<span class="keyword">include</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加源文件目录</span></span><br><span class="line"><span class="keyword">add_subdirectory</span>(src)  </span><br><span class="line"></span><br><span class="line"><span class="comment">#将当前文件夹重新取名为 SRC_LIST</span></span><br><span class="line"><span class="keyword">aux_source_directory</span>(. SRC_LIST) </span><br><span class="line"></span><br><span class="line"><span class="comment">#编译时添加参数</span></span><br><span class="line">add_definition(<span class="string">&quot;-g&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#生成一个可执行文件，使用的是当前文件夹下的所有文件</span></span><br><span class="line"><span class="keyword">add_executable</span>(logger <span class="variable">$&#123;SRC_LIST&#125;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="当找不到头文件的时候，有可能是我们的CMakeLists-txt文件中没有包含到头文件的文件夹，加上就好了"><a href="#当找不到头文件的时候，有可能是我们的CMakeLists-txt文件中没有包含到头文件的文件夹，加上就好了" class="headerlink" title="当找不到头文件的时候，有可能是我们的CMakeLists.txt文件中没有包含到头文件的文件夹，加上就好了"></a>当找不到头文件的时候，有可能是我们的CMakeLists.txt文件中没有包含到头文件的文件夹，加上就好了</h5><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114219485.png" alt="image-20220728114219485"></p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114229570.png" alt="image-20220728114229570"></p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114246518.png" alt="image-20220728114246518"></p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114304332.png" alt="image-20220728114304332"></p>
<h1 id="分布式系统框架-项目介绍"><a href="#分布式系统框架-项目介绍" class="headerlink" title="分布式系统框架&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;项目介绍"></a>分布式系统框架&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;项目介绍</h1><h2 id="distribute-system-framework"><a href="#distribute-system-framework" class="headerlink" title="(distribute-system-framework)"></a>(distribute-system-framework)</h2><p><strong>单体</strong>-》<strong>集群</strong>-》<strong>分布式</strong></p>
<p>一个基于Linux平台，使用C++编写的分布式系统框架。服务器端采用了线程池+Libevent的IO模型，并为其实现了简单的负载均衡。服务器端业务层使用了MVC的设计模式。数据存储方面对MySQL数据库C-API进行了C++的类封装。为了实现服务器集群的负载均衡，实现了以一致性hash为底层算法的负载均衡服务器，这可以作为一个单独的模块。</p>
<h5 id="项目文件目录："><a href="#项目文件目录：" class="headerlink" title="项目文件目录："></a>项目文件目录：</h5><ul>
<li><p>logger &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 日志类</p>
<ul>
<li><p>logger.h</p>
</li>
<li><p>message.h</p>
</li>
<li><p>timeStemp.h &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 时间戳是日志的组成部分，时间戳又有多个部分组成，所以将其独立出来。</p>
</li>
</ul>
</li>
<li><p>mainServer</p>
<ul>
<li>mainServer.h</li>
</ul>
</li>
<li><p>mysqldb</p>
<ul>
<li>mysqldb.h</li>
</ul>
</li>
<li><p>reactor</p>
<ul>
<li>reactor.h</li>
</ul>
</li>
<li><p>redis</p>
<ul>
<li>redis.h</li>
</ul>
</li>
<li><p>thread</p>
<ul>
<li>thread.h</li>
</ul>
</li>
<li><p>threadPool</p>
<ul>
<li>threadPool.h</li>
</ul>
</li>
<li><p>untils</p>
<ul>
<li><p>ipAddressPort.h</p>
</li>
<li><p>msg.h</p>
</li>
<li><p>tcpClient.h</p>
</li>
<li><p>tcpServer.h</p>
</li>
</ul>
</li>
<li><p>controller</p>
<ul>
<li>controller.h</li>
</ul>
</li>
<li><p>view</p>
<ul>
<li>view.h</li>
</ul>
</li>
<li><p>public.h</p>
</li>
<li><p>json.h</p>
</li>
</ul>
<h5 id="项目的逻辑图"><a href="#项目的逻辑图" class="headerlink" title="项目的逻辑图"></a>项目的逻辑图</h5><h1 id="项目当中的技术栈"><a href="#项目当中的技术栈" class="headerlink" title="项目当中的技术栈"></a>项目当中的技术栈</h1><ul>
<li><p>日志类编写中的拓展</p>
<ul>
<li><p>单例模式</p>
<ul>
<li><p>懒汉式</p>
</li>
<li><p>饿汉式</p>
</li>
<li><p>线程安全的单例模式</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>github gitee gitlab     三个代码仓库的区别：</p>
<h2 id="第一节、日志类的实现"><a href="#第一节、日志类的实现" class="headerlink" title="第一节、日志类的实现"></a>第一节、日志类的实现</h2><h3 id=""><a href="#" class="headerlink" title=""></a><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220727171110991.png" alt="image-20220727171110991"></h3><p>由上图我们可以看出，我们将日志封装成一个类，日志类包含了多个成员，其中日志<strong>时间戳</strong>又是包含了多个成员的类。所以我们需要将时间戳单独封装一次，再将其作为成员封装到日志类当中。</p>
<h3 id="（一）、时间戳的实现"><a href="#（一）、时间戳的实现" class="headerlink" title="（一）、时间戳的实现"></a>（一）、时间戳的实现</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TimeStamp</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">TimeStamp</span>();</span><br><span class="line">    <span class="built_in">TimeStamp</span>(<span class="type">__uint64_t</span>);</span><br><span class="line">    <span class="function">std::string <span class="title">ToString</span><span class="params">()</span><span class="type">const</span></span>;</span><br><span class="line">    <span class="function"><span class="type">static</span> TimeStamp <span class="title">Now</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> : </span><br><span class="line">    <span class="type">time_t</span> m_microSecondSinceEpoch;</span><br><span class="line">&#125;;</span><br><span class="line">TimeStamp::<span class="built_in">TimeStamp</span>():<span class="built_in">m_microSecondSinceEpoch</span>(<span class="number">0</span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line">TimeStamp::<span class="built_in">TimeStamp</span>(<span class="type">__uint64_t</span> microSecondSinceEpoch):<span class="built_in">m_microSecondSinceEpoch</span>(microSecondSinceEpoch)&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">std::string <span class="title">TimeStamp::ToString</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">tm</span> t;</span><br><span class="line">    <span class="built_in">localtime_r</span>(&amp;m_microSecondSinceEpoch,&amp;t);</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> buf[SMALL_BUF_LEN]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">snprintf</span>(buf, SMALL_BUF_LEN, <span class="string">&quot;[%04d/%02d/%02d %02d:%02d:%02d]&quot;</span>,</span><br><span class="line">     t.tm_year + <span class="number">1900</span>, t.tm_mon + <span class="number">1</span>, t.tm_mday, </span><br><span class="line">     t.tm_hour, t.tm_min, t.tm_sec);</span><br><span class="line">    <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">TimeStamp <span class="title">TimeStamp::Now</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">TimeStamp</span>(<span class="built_in">time</span>(<span class="literal">NULL</span>));<span class="comment">//返回当前时间戳</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114545229.png" alt="image-20220728114545229"></p>
<p>时间戳完成之后，进行提交到本地版本库；</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114649118.png" alt="image-20220728114649118"></p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114719567.png" alt="image-20220728114719567"></p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728114737764.png" alt="image-20220728114737764"></p>
<h2 id="（二）、文件名、函数名、行号的实现"><a href="#（二）、文件名、函数名、行号的实现" class="headerlink" title="（二）、文件名、函数名、行号的实现"></a>（二）、文件名、函数名、行号的实现</h2><p>这三个都有C语言的内置类型可以实现，</p>
<p><strong>LINE</strong>:行号</p>
<p>__FUNCTION__：函数名</p>
<p><strong>FILE</strong>:文件名</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;filename:%s,linNumber:%d,Function:%S&quot;</span>,__FILE__,__lINE__,__FUNCTION__);</span><br></pre></td></tr></table></figure>

<h2 id="（三）、日志类的实现"><a href="#（三）、日志类的实现" class="headerlink" title="（三）、日志类的实现"></a>（三）、日志类的实现</h2><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728191315255.png" alt="image-20220728191315255"></p>
<p>类图：</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729134439464.png" alt="image-20220729134439464"></p>
<p>日志信息包含日志头和日志信息等内容，当我们要将日志信息打印到终端的时候需要给各个字段赋予颜色，然后打印出相应的格式，这里我们用到了stringstream类，通过流的方式对日志信息进行操作。</p>
<p>值得注意的是，由于C语言当中有内置的__FILE__,<strong>FUNCTION</strong>,__LINE__分别表示文件名，函数名和行号，所以我们列举或声明类型的时候要避免该类型的词的出现，以免出现重定义，导致程序编译出错。</p>
<p>代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __MESSAGE_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __MESSAGE_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;public.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Message</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::string m_colorHeader; <span class="comment">//带颜色的日志头，打印到终端</span></span><br><span class="line">    std::string m_commonHeader; <span class="comment">//不带颜色的日志头，打印到文件</span></span><br><span class="line">    std::string m_msg;          <span class="comment">//日志信息</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化日志颜色</span></span><br><span class="line">    <span class="function">std::string <span class="title">formatFieldWithColor</span><span class="params">(COLOR_NUMBER , <span class="type">bool</span> ,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> std::string&amp; , <span class="type">const</span> std::string &amp;, <span class="type">bool</span> )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Message</span>(LOG_LEVEL , std::string , std::string , <span class="type">int</span> );</span><br><span class="line">    <span class="comment">// 格式化日志头</span></span><br><span class="line">    <span class="comment">// [时间戳][日志级别][文件名称][函数名称][行号]</span></span><br><span class="line">    <span class="function">std::string <span class="title">FormatHeader</span><span class="params">(LOG_LEVEL,std::string,std::string,<span class="type">int</span>,<span class="type">bool</span>)</span></span>;</span><br><span class="line">    <span class="function">std::string <span class="title">ToString</span><span class="params">(<span class="type">bool</span>)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    Message &amp;<span class="keyword">operator</span>&lt;&lt;(<span class="type">const</span> T &amp;t)</span><br><span class="line">    &#123;</span><br><span class="line">        std::stringstream ss;</span><br><span class="line">        ss &lt;&lt; t;</span><br><span class="line">        m_msg += ss.<span class="built_in">str</span>();</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>



<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;message.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;public.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;timeStamp.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">colorNumber:色号</span></span><br><span class="line"><span class="comment">dark：是否是神色，0为浅色，1为深色</span></span><br><span class="line"><span class="comment">delimiter：分隔符</span></span><br><span class="line"><span class="comment">fieldName：字段名称</span></span><br><span class="line"><span class="comment">colored：是否上色，0不上，1上色</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">std::string <span class="title">Message::formatFieldWithColor</span><span class="params">(COLOR_NUMBER colorNumber, <span class="type">bool</span> dark,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> std::string &amp;delimiter, <span class="type">const</span> std::string &amp;fieldName, </span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">bool</span> colored)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//文件流对象</span></span><br><span class="line">    std::stringstream ss;</span><br><span class="line">    <span class="keyword">if</span>(colored)</span><br><span class="line">    &#123;</span><br><span class="line">        ss&lt;&lt;<span class="string">&quot;\033[&quot;</span>&lt;&lt;dark&lt;&lt;<span class="string">&quot;;&quot;</span>&lt;&lt;colorNumber&lt;&lt;<span class="string">&quot;m &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ss &lt;&lt; fieldName;</span><br><span class="line">    <span class="keyword">if</span> (colored)</span><br><span class="line">    &#123;</span><br><span class="line">        ss&lt;&lt;<span class="string">&quot;\033[0m&quot;</span>;<span class="comment">//重置属性</span></span><br><span class="line">    &#125;</span><br><span class="line">    ss &lt;&lt; delimiter;</span><br><span class="line">    <span class="keyword">return</span> ss.<span class="built_in">str</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Message::<span class="built_in">Message</span>(LOG_LEVEL level,std::string fileName,</span><br><span class="line">std::string functionName,<span class="type">int</span> lineNumber)</span><br><span class="line">&#123;</span><br><span class="line">    m_colorHeader = <span class="built_in">FormatHeader</span>(level,fileName,functionName,lineNumber,<span class="literal">true</span>);</span><br><span class="line">    m_commonHeader = <span class="built_in">FormatHeader</span>(level, fileName, functionName, lineNumber,<span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 格式化日志头</span></span><br><span class="line"><span class="comment">// [时间戳][日志级别][文件名称][函数名称][行号]</span></span><br><span class="line"><span class="function">std::string <span class="title">Message::FormatHeader</span><span class="params">(LOG_LEVEL level,std::string fileName,</span></span></span><br><span class="line"><span class="params"><span class="function">std::string functionName,<span class="type">int</span> lineNumber, <span class="type">bool</span> colored = <span class="literal">true</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//时间戳</span></span><br><span class="line">    std::stringstream ss;</span><br><span class="line">    ss&lt;&lt;formatFieldWithColor(DEFAUL_COLOR,<span class="number">0</span>,<span class="string">&quot;|&quot;</span>,TimeStamp::<span class="built_in">Now</span>().<span class="built_in">ToString</span>(),colored);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//日志级别</span></span><br><span class="line">    COLOR_NUMBER logLevelColor = LogLevelColor[level]; <span class="comment">//日志级别的颜色</span></span><br><span class="line">    std::string logType = LogFeildType[level];  <span class="comment">//日志级别的类型</span></span><br><span class="line">    ss &lt;&lt; formatFieldWithColor(logLevelColor, <span class="number">1</span>, <span class="string">&quot;|&quot;</span>, logType, colored);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//文件名称</span></span><br><span class="line">    COLOR_NUMBER fileNameColor = LogFeildColor[FILE_NAME];</span><br><span class="line">    ss &lt;&lt; formatFieldWithColor(fileNameColor, <span class="number">1</span>, <span class="string">&quot;|&quot;</span>, fileName, colored);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//函数名称</span></span><br><span class="line">    COLOR_NUMBER functionColor = LogFeildColor[FUNCTION_NAME];</span><br><span class="line">    ss &lt;&lt; formatFieldWithColor(functionColor, <span class="number">1</span>, <span class="string">&quot;|&quot;</span>, functionName, colored);</span><br><span class="line">    <span class="comment">//行号</span></span><br><span class="line">    COLOR_NUMBER lineColor = LogFeildColor[LINE];</span><br><span class="line">    ss &lt;&lt; formatFieldWithColor(lineColor, <span class="number">1</span>, <span class="string">&quot;|&quot;</span>, std::<span class="built_in">to_string</span>(lineNumber), colored);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ss.<span class="built_in">str</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">std::string <span class="title">Message::ToString</span><span class="params">(<span class="type">bool</span> colored = <span class="literal">true</span>)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> colored ? m_colorHeader + m_msg : m_commonHeader + m_msg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Message <span class="title">msg</span><span class="params">(INFO, __FILE__, __FUNCTION__, __LINE__)</span></span>;</span><br><span class="line">    std::cout &lt;&lt; msg.<span class="built_in">ToString</span>() &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220728194756012.png" alt="image-20220728194756012"></p>
<h3 id="（三）、封装日志类"><a href="#（三）、封装日志类" class="headerlink" title="（三）、封装日志类"></a>（三）、封装日志类</h3><p>日志类的主要作用是将日志信息打印到终端或者日志文件当中，需要的成员变量分别是</p>
<ul>
<li><p>决定是否打印到终端或者日志文件的两个布尔值，</p>
</li>
<li><p>一个文件流对象决定到底打印到那个文件当中，</p>
</li>
<li><p>还有一个日志级别决定了日志的内容形式。</p>
</li>
</ul>
<p>日志类封装完成之后，将其与日志信息类进行拼接就可以打印出我们想要的日志信息，并且在日志文件当中还有备份。</p>
<p>类图：</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729135125765.png"></p>
<p>FATAL级别的日志是一个特殊的情况，当我们遇到FATAL的时候，说明程序已经遇到了很严重的问题，需要终止程序，但是不能够随意加上额此贴（0）因为会影响其他级别的日志输出，所以要经过特殊的处理。</p>
<p>代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __LOGGER_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __LOGGER_H__</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;message.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;public.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用单例模式</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">懒汉式</span></span><br><span class="line"><span class="comment">饿汉式</span></span><br><span class="line"><span class="comment">线程安全的单例模式</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1、把构造函数私有化</span></span><br><span class="line"><span class="comment">2、提供生成对象的静态方法</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">单例模式  迭代器模式 简单工厂 抽象工厂 工厂方法  观察者模式 装饰器模式</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Logger</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">Logger</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// if (NULL == getenv(&quot;LOG_LEVEL&quot;))</span></span><br><span class="line">        <span class="comment">// if (nullptr == getenv(&quot;LOG_LEVEL&quot;))</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">getenv</span>(<span class="string">&quot;LOG_LEVEL&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            m_level = INFO;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 断言 getenv(&quot;LOG_LEVEL&quot;)的返回值一定是 &quot;INFO&quot; &quot;ERROR&quot; &quot;DEBUG&quot; &quot;FATAL&quot;</span></span><br><span class="line">            m_level = LogFeildType[<span class="built_in">getenv</span>(<span class="string">&quot;LOG_LEVEL&quot;</span>)];</span><br><span class="line">        &#125;</span><br><span class="line">        m_logToLogFile = <span class="literal">true</span>;</span><br><span class="line">        m_logToTerminal = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> m_logToTerminal;<span class="comment">//判断日志是否打印到终端</span></span><br><span class="line">    <span class="type">bool</span> m_logToLogFile; <span class="comment">//判断日志是否打印到日志文件当中</span></span><br><span class="line">    std::fstream m_logFile; <span class="comment">//日志文件</span></span><br><span class="line">    LOG_LEVEL m_level;  <span class="comment">//日志级别</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> Logger* <span class="title">Getinstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">static</span> Logger logger;</span><br><span class="line">        <span class="keyword">return</span> &amp;logger;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">///设置是否打印到终端</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">SetLogToTerminal</span><span class="params">(<span class="type">bool</span> logToTerminal)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">GetLogToTerminal</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置是否打印到日志文件当中</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">SetLogToLogFile</span><span class="params">(<span class="type">bool</span> logToLogFile)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">GetLogToLogFile</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置日志文件</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">SetLogFile</span><span class="params">(<span class="type">const</span> std::string&amp; logFileName)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置日志级别</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">SetLogLevel</span><span class="params">(LOG_LEVEL level)</span></span>;</span><br><span class="line">    <span class="function">LOG_LEVEL <span class="title">GetLogLevel</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如何使用message类  类和类之间的关系 Logger&amp;Message</span></span><br><span class="line">    <span class="comment">// void append(const Message&amp; msg)</span></span><br><span class="line">    <span class="type">void</span> <span class="keyword">operator</span>+=(<span class="type">const</span> Message &amp;msg)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (m_logToTerminal)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 打印到终端里边的日志 需要带颜色</span></span><br><span class="line">            std::cout &lt;&lt; msg.<span class="built_in">ToString</span>(<span class="literal">true</span>) &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (m_logToLogFile)</span><br><span class="line">        &#123;</span><br><span class="line">            m_logFile &lt;&lt; msg.<span class="built_in">ToString</span>(<span class="literal">false</span>) &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//假如遇到FATAL级别的日志，说明文件出现处理不了的错误，需要终止，为了不影响其他级别的日志输出，所以单独列出</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="keyword">if</span> (msg.<span class="built_in">ToString</span>().<span class="built_in">find</span>(<span class="string">&quot;FATAL&quot;</span>) != std::string::npos)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;fatal happened!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> </span></span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;logger.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">///设置是否打印到终端</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Logger::SetLogToTerminal</span><span class="params">(<span class="type">bool</span> logToTerminal)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_logToTerminal = logToTerminal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Logger::GetLogToTerminal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> m_logToTerminal;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置是否打印到日志文件当中</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Logger::SetLogToLogFile</span><span class="params">(<span class="type">bool</span> logToLogFile)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_logToLogFile = m_logToLogFile;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Logger::GetLogToLogFile</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> m_logToLogFile;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//设置日志文件</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Logger::SetLogFile</span><span class="params">(<span class="type">const</span> std::string &amp;logFileName = <span class="string">&quot;dsf.log&quot;</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(m_logFile.<span class="built_in">is_open</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//如果m_logFile已经打开了其他文件就先将其关闭，然后再打开指定的日志文件</span></span><br><span class="line">        m_logFile.<span class="built_in">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    m_logFile.<span class="built_in">open</span>(logFileName);</span><br><span class="line">    <span class="comment">//既然打开了日志文件，肯定是要网日志文件当中写入的</span></span><br><span class="line">    m_logToLogFile = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置日志级别</span></span><br><span class="line"><span class="comment">//通过环境变量来设置，getenv(),环境变量可以通过自己来设置（expor）</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Logger::SetLogLevel</span><span class="params">(LOG_LEVEL level)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_level = level;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LOG_LEVEL <span class="title">Logger::GetLogLevel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> m_level;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Message msg1(INFO, __FILE__, __FUNCTION__, __LINE__);</span></span><br><span class="line"><span class="comment">    Message msg2(ERROR, __FILE__, __FUNCTION__, __LINE__);</span></span><br><span class="line"><span class="comment">    Message msg3(FATAL, __FILE__, __FUNCTION__, __LINE__);</span></span><br><span class="line"><span class="comment">    Message msg4(DEBUG, __FILE__, __FUNCTION__, __LINE__);</span></span><br><span class="line"><span class="comment">    msg1 &lt;&lt; &quot;hello world1&quot;;</span></span><br><span class="line"><span class="comment">    msg2 &lt;&lt; &quot;hello world2&quot;;</span></span><br><span class="line"><span class="comment">    msg3 &lt;&lt; &quot;hello world3&quot;;</span></span><br><span class="line"><span class="comment">    msg4 &lt;&lt; &quot;hello world4&quot;;</span></span><br><span class="line"><span class="comment">    std::cout &lt;&lt; msg1.ToString() &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">    std::cout &lt;&lt; msg2.ToString() &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">    std::cout &lt;&lt; msg3.ToString() &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">    std::cout &lt;&lt; msg4.ToString() &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   LOG_INFO&lt;&lt;<span class="string">&quot;hello world!&quot;</span>;</span><br><span class="line">   LOG_ERROR&lt;&lt;<span class="string">&quot;hello world!&quot;</span>;</span><br><span class="line">   LOG_DEBUG&lt;&lt;<span class="string">&quot;hello world!&quot;</span>;</span><br><span class="line">   LOG_FATAL&lt;&lt; <span class="string">&quot;hello world!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>测试截图：</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729171429467.png" alt="image-20220729171429467"></p>
<h2 id="（四）、封装TCP连接类"><a href="#（四）、封装TCP连接类" class="headerlink" title="（四）、封装TCP连接类"></a>（四）、封装TCP连接类</h2><p>先来回顾一下tcp的编程流程，</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729180823959.png" alt="image-20220729180823959"></p>
<p>使用API接口编程十分的繁琐，没产生一个服务器或者客户端就需要进行一次上面的流程，非常的麻烦，所以我将其封装到一个类当中，以方便的创建服务器端和客户端</p>
<p>类图：</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729181027754.png" alt="image-20220729181027754"></p>
<h4 id="封装IP和port类："><a href="#封装IP和port类：" class="headerlink" title="封装IP和port类："></a>封装IP和port类：</h4><p>将IP和端口封装到一个类当中，在调用的时候直接调用方法就可以了</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729183806790.png" alt="image-20220729183806790"></p>
<p>代码实现</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __IPADDRESSPORT_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __IPADDRESSPORT_H__</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//封装IP地址和端口号</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IpAddressPort</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::string m_ip;   <span class="comment">//IP地址</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> m_port; <span class="comment">//端口号</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">IpAddressPort</span>(std::string,<span class="type">unsigned</span> <span class="type">short</span>);</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">SetIpAddress</span><span class="params">(std::string)</span></span>;</span><br><span class="line">    <span class="function">std::string <span class="title">GetIpAddress</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">SetPort</span><span class="params">(<span class="type">unsigned</span> <span class="type">short</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">unsigned</span> <span class="type">short</span> <span class="title">GetPort</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">std::string <span class="title">ToString</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ipAddressPort.h&quot;</span></span></span><br><span class="line">IpAddressPort::<span class="built_in">IpAddressPort</span>(std::string ip = <span class="string">&quot;127.0.0.1&quot;</span>, <span class="type">unsigned</span> <span class="type">short</span> port = <span class="number">3306</span>)</span><br><span class="line"> : <span class="built_in">m_ip</span>(ip), <span class="built_in">m_port</span>(port) &#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IpAddressPort::SetIpAddress</span><span class="params">(std::string ip)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_ip = ip;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">std::string <span class="title">IpAddressPort::GetIpAddress</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> m_ip;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IpAddressPort::SetPort</span><span class="params">(<span class="type">unsigned</span> <span class="type">short</span> port)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_port = port;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">short</span> <span class="title">IpAddressPort::GetPort</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> m_port;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">std::string <span class="title">IpAddressPort::ToString</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::stringstream ss;</span><br><span class="line">    ss &lt;&lt; m_ip &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; m_port;</span><br><span class="line">    <span class="keyword">return</span> ss.<span class="built_in">str</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//测试用例，我们的IP和端口是有默认值的（127.0.0.1:3306）</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    IpAddressPort ip_port;</span><br><span class="line">    std::cout&lt;&lt;ip_port.<span class="built_in">ToString</span>()&lt;&lt;std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试效果：</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220729184111289.png" alt="image-20220729184111289"></p>
<h4 id="封装tcpClient和TCPServer"><a href="#封装tcpClient和TCPServer" class="headerlink" title="封装tcpClient和TCPServer"></a>封装tcpClient和TCPServer</h4><p>将客户端所需要的文件描述符和connect，send，recv等方法封装到一个类当中。</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730131847723.png" alt="image-20220730131847723"></p>
<p>代码实现：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __TCPCLIENT_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __TCPCLIENT_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;logger.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ipAddressPort.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TcpClient</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> m_sfd; <span class="comment">//套接字描述符</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">TcpClient</span>(IpAddressPort &amp;ip_port);</span><br><span class="line">    ~<span class="built_in">TcpClient</span>();</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">SendMsg</span><span class="params">(<span class="type">const</span> std::string&amp; msg)</span></span>;<span class="comment">//发送消息</span></span><br><span class="line">    <span class="function">Msg <span class="title">RecvMsg</span><span class="params">()</span></span>;<span class="comment">//接收消息，m_msg作为传入参数，将接收到消息存入msg中,m_numberOFsend接收到的字节数</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="type">const</span> <span class="title">GetSfd</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> </span></span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;tcpClient.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//socket &amp;&amp; connect</span></span><br><span class="line">TcpClient::<span class="built_in">TcpClient</span>(IpAddressPort&amp; ip_port)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    m_sfd = <span class="built_in">socket</span>(AF_INET,SOCK_STREAM,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(m_sfd == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_FATAL &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> saddr;</span><br><span class="line">    <span class="built_in">memset</span>(&amp;saddr,<span class="number">0</span>,<span class="built_in">sizeof</span>(saddr));</span><br><span class="line"></span><br><span class="line">    saddr.sin_family = AF_INET;</span><br><span class="line">    saddr.sin_addr.s_addr = <span class="built_in">inet_addr</span>(ip_port.<span class="built_in">GetIpAddress</span>().<span class="built_in">c_str</span>());</span><br><span class="line">    saddr.sin_port = <span class="built_in">htons</span>(ip_port.<span class="built_in">GetPort</span>());</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> fd = <span class="built_in">connect</span>(m_sfd,(<span class="keyword">struct</span> sockaddr*)&amp;saddr,<span class="built_in">sizeof</span>(saddr));</span><br><span class="line">    <span class="keyword">if</span>(fd == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_ERROR &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    LOG_INFO &lt;&lt; <span class="string">&quot;connect sucess&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//close</span></span><br><span class="line">TcpClient::~<span class="built_in">TcpClient</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == <span class="built_in">close</span>(m_sfd))</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_FATAL &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//send</span></span><br><span class="line"><span class="function"><span class="type">int</span>  <span class="title">TcpClient::SendMsg</span><span class="params">(<span class="type">const</span> std::string &amp;msg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> numberOfSend = <span class="built_in">send</span>(m_sfd,&amp;msg,<span class="built_in">strlen</span>(msg.<span class="built_in">c_str</span>()),<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == numberOfSend)</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_ERROR &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> numberOfSend;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//recv</span></span><br><span class="line"><span class="function">Msg <span class="title">TcpClient::RecvMsg</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> buf[MEDIA_BUF_LEN] =&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> numberOfRecv = <span class="built_in">recv</span>(m_sfd,buf,MEDIA_BUF_LEN,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(numberOfRecv == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_ERROR &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="function">Msg <span class="title">msg</span><span class="params">(buf,numberOfRecv)</span></span>;</span><br><span class="line">    <span class="keyword">return</span> msg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="type">const</span> <span class="title">TcpClient::GetSfd</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> m_sfd;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">IpAddressPort <span class="title">cli</span><span class="params">(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">5000</span>)</span></span>;</span><br><span class="line">    <span class="function">TcpClient <span class="title">Client</span><span class="params">(cli)</span></span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务端和客户端基本上是一致的，不同点在于，我们需要在服务端的构造函数中封装更多的东西（socket&#x2F;bind&#x2F;listen）,此外服务端的accept也需要独立出来。</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730132210416.png" alt="image-20220730132210416"></p>
<p>代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __TCPSERVER_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __TCPSERVER_H__</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;logger.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ipAddressPort.h&quot;</span> </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TcpServer</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> m_lfd;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">TcpServer</span>(IpAddressPort&amp; ip_port);</span><br><span class="line">    ~<span class="built_in">TcpServer</span>();</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">Accept</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">SendMsg</span><span class="params">(<span class="type">int</span> ,<span class="type">const</span> std::string &amp;msg)</span></span>; <span class="comment">//发送消息</span></span><br><span class="line">    <span class="function">Msg <span class="title">RecvMsg</span><span class="params">(<span class="type">int</span>)</span></span>; <span class="comment">//接收消息，m_msg作为传入参数，将接收到消息存入msg中,m_numberOFsend接收到的字节数</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="type">const</span> <span class="title">GetSfd</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;tcpServer.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">TcpServer::<span class="built_in">TcpServer</span>(IpAddressPort &amp;ip_port)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//socket</span></span><br><span class="line">    m_lfd = <span class="built_in">socket</span>(AF_INET,SOCK_STREAM,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">-1</span> == m_lfd)</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_FATAL &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> saddr;</span><br><span class="line">    <span class="built_in">memset</span>(&amp;saddr,<span class="number">0</span>,<span class="built_in">sizeof</span>(saddr));</span><br><span class="line"></span><br><span class="line">    saddr.sin_addr.s_addr = <span class="built_in">inet_addr</span>(ip_port.<span class="built_in">GetIpAddress</span>().<span class="built_in">c_str</span>());</span><br><span class="line">    saddr.sin_family = AF_INET;</span><br><span class="line">    saddr.sin_port = <span class="built_in">htons</span>(ip_port.<span class="built_in">GetPort</span>());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//bind</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="number">-1</span> == <span class="built_in">bind</span>(m_lfd,(<span class="keyword">struct</span> sockaddr*)&amp;saddr,<span class="built_in">sizeof</span>(saddr)))</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_FATAL &lt;&lt;<span class="built_in">strerror</span>(errno);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//listen</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="number">-1</span> == <span class="built_in">listen</span>(m_lfd,<span class="number">5</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_FATAL &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//close</span></span><br><span class="line">TcpServer::~<span class="built_in">TcpServer</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">-1</span> == <span class="built_in">close</span>(m_lfd))</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_FATAL &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">TcpServer::Accept</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> cli;</span><br><span class="line">    <span class="type">socklen_t</span> len = <span class="built_in">sizeof</span>(cli);</span><br><span class="line">    <span class="type">int</span> cfd = <span class="built_in">accept</span>(m_lfd, (<span class="keyword">struct</span> sockaddr *)&amp;cli, &amp;len);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == cfd)</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_ERROR &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span> clientIpBuf[SMALL_BUF_LEN] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">inet_ntop</span>(AF_INET, &amp;cli.sin_addr, clientIpBuf, SMALL_BUF_LEN))</span><br><span class="line">        &#123;</span><br><span class="line">            LOG_ERROR &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 数据的转换   网络字节序 -》 本机字节序</span></span><br><span class="line">            std::string <span class="built_in">clientIp</span>(clientIpBuf);</span><br><span class="line">            <span class="type">unsigned</span> <span class="type">short</span> clientPort = <span class="built_in">ntohs</span>(cli.sin_port);</span><br><span class="line">            <span class="function">IpAddressPort <span class="title">ipAddressPort</span><span class="params">(clientIp, clientPort)</span></span>;</span><br><span class="line">            LOG_INFO &lt;&lt; ipAddressPort.<span class="built_in">ToString</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cfd;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">TcpServer::SendMsg</span><span class="params">(<span class="type">int</span> cfd, <span class="type">const</span> std::string &amp;msg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> numberOfSendByte = <span class="built_in">send</span>(cfd, msg.<span class="built_in">c_str</span>(), <span class="built_in">strlen</span>(msg.<span class="built_in">c_str</span>()), <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == numberOfSendByte)</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_ERROR &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> numberOfSendByte;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Msg <span class="title">TcpServer::RecvMsg</span><span class="params">(<span class="type">int</span> cfd)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> buf[LARGE_BUF_LEN] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> numberOfRecvByte = <span class="built_in">recv</span>(cfd, buf, LARGE_BUF_LEN, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == numberOfRecvByte)</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_ERROR &lt;&lt; <span class="built_in">strerror</span>(errno);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Msg&#123;buf, numberOfRecvByte&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="type">const</span> <span class="title">TcpServer::GetSfd</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> m_lfd;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">IpAddressPort <span class="title">cli</span><span class="params">(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">5000</span>)</span></span>;</span><br><span class="line">    <span class="function">TcpServer <span class="title">ser</span><span class="params">(cli)</span></span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cfd = ser.<span class="built_in">Accept</span>();</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">-1</span> == cfd)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h5><p>当我们的项目进行到当前位置时，我们的所有源代码经过编译之后应该生成两个可执行文件，分别是client和server，此时已经不能再用之前的方式进行编译了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">给每个子文件夹下都加上CmakLists.txt文件是不可行的，因为子文件架下的CmakLists.txt只可见当前文件夹下的所有文件，对于我们要生成多个可执行文件是行不通的。</span><br></pre></td></tr></table></figure>

<p>此时们应该上升到src文件夹下面</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730132738608.png" alt="image-20220730132738608"></p>
<p><em>只需要对部分源文件进行编译时，直接将需要的源文件放到目标文件的后面因为 .&#x2F;utils里面包括了tcpClient.cpp和tcpServer.cpp两个源文件，所以不能通过aux_source_directory(.&#x2F;utils&#x2F;</em> UTILS)的方法生成两个不同的可执行文件。*</p>
<p>此时子文件夹下没有cmake文件，只有src下面有，内容为：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_definitions</span>(<span class="string">&quot;-g -std=c++11&quot;</span>) </span><br><span class="line"><span class="keyword">add_executable</span>(client ./logger/logger.cpp ./logger/<span class="keyword">message</span>.cpp ./logger/timeStamp.cpp ./utils/tcpClient.cpp ./utils/ipAddressPort.cpp)</span><br><span class="line"><span class="keyword">add_executable</span>(server ./logger/logger.cpp ./logger/<span class="keyword">message</span>.cpp ./logger/timeStamp.cpp ./utils/tcpServer.cpp ./utils/ipAddressPort.cpp)</span><br></pre></td></tr></table></figure>

<h6 id="测试结果："><a href="#测试结果：" class="headerlink" title="测试结果："></a>测试结果：</h6><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730133009527.png" alt="image-20220730133009527"></p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730133120133.png" alt="image-20220730133120133"></p>
<h2 id="五-、封装线程类"><a href="#五-、封装线程类" class="headerlink" title="(五)、封装线程类"></a>(五)、封装线程类</h2><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220730172546525.png" alt="image-20220730172546525"></p>
<h5 id="协程是如何实现的"><a href="#协程是如何实现的" class="headerlink" title="协程是如何实现的?"></a>协程是如何实现的?</h5><h4 id="线程函数为什么要设置成静态的呢？"><a href="#线程函数为什么要设置成静态的呢？" class="headerlink" title="线程函数为什么要设置成静态的呢？"></a>线程函数为什么要设置成静态的呢？</h4><p>因为我pthread_create()要求的thread_fun函数有要求，  只能有一个（void*)参数，如果非静态，就会默认含有一个（this.)，故要设置为静态的。</p>
<p>将线程函数设置成静态之后，随之而来又会产生问题，静态成员函数只能访问静态成员变量，那么我们的静态成员函数如何访问我们的内部成员变量呢？这时我们只需要将this*当做参数传入到线程函数当中就可以进行间接的访问了。</p>
<h4 id="线程间通信："><a href="#线程间通信：" class="headerlink" title="线程间通信："></a>线程间通信：</h4><p>socketpair：创建一个全局的无名管道</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int socketpair（）</span><br></pre></td></tr></table></figure>

<p>pipe</p>
<p>全局变量</p>
<h2 id="项目分析："><a href="#项目分析：" class="headerlink" title="项目分析："></a>项目分析：</h2><p>项目逻辑架构：</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220803152716787.png" alt="image-20220803152716787"></p>
<p>此项以上的记录只完成了网络层的编程准备，相应的组件封装工作。</p>
<h2 id="封装reactor、ctroller和View"><a href="#封装reactor、ctroller和View" class="headerlink" title="封装reactor、ctroller和View"></a>封装reactor、ctroller和View</h2><h3 id="reactor："><a href="#reactor：" class="headerlink" title="reactor："></a>reactor：</h3><h4 id="什么是reactor？"><a href="#什么是reactor？" class="headerlink" title="什么是reactor？"></a>什么是reactor？</h4><ol>
<li>事件驱动（event handling）</li>
<li>可以处理一个或多个输入源（one or more inputs）</li>
<li>通过Service Handler同步的将输入事件（Event）采用多路复用分发给相应的Request Handler（多个）处理</li>
</ol>
<p>reactor就是将IO复用中的一些接口封装起来，封装成一个类。来一个相应的事件，reactor就有对应的响应。</p>
<h4 id="结合到项目当中"><a href="#结合到项目当中" class="headerlink" title="结合到项目当中"></a>结合到项目当中</h4><p>当我们的服务器在监听来自客户端的请求时listen函数处于循环工作状态，accept出去阻塞状态，当有完成三次握手的请求后，会唤醒accept函数，对请求给与相应的处理。</p>
<p>此时系统会给与其分配线程处理请求</p>
<h4 id="one-loop-per-thread：一个线程配一个reactor每个reactor都监听自己的thread。"><a href="#one-loop-per-thread：一个线程配一个reactor每个reactor都监听自己的thread。" class="headerlink" title="one loop per thread：一个线程配一个reactor每个reactor都监听自己的thread。"></a>one loop per thread：一个线程配一个reactor每个reactor都监听自己的thread。</h4><h4 id="C-中的MVC（分层都是为了解耦）"><a href="#C-中的MVC（分层都是为了解耦）" class="headerlink" title="C++中的MVC（分层都是为了解耦）"></a>C++中的MVC（分层都是为了解耦）</h4><ul>
<li><p>medel:数据的存储模块，底层封装了（orm：对象关系映射）把数据库表中的一行映射成程序中的一个对象。</p>
</li>
<li><p>view：具体业务的实现方式，处理函数（多态）</p>
</li>
<li><p>ctroller：上层传下数据之后，根据具体的业务，为其分配对应的view层处理函数</p>
</li>
</ul>
<p>在我们的程序当中，有我们的子线程来处理IO事件，那么我给每个子线程配一个ctroller，这个ctroller里面存一个MAP表，里面只有一个方法，process，将拿到的数据转到处理他的方法当中<img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220802142150145.png" alt="image-20220802142150145"></p>
<p>业务的处理函数在view层当中。</p>
<h4 id="使用mysql提供的API接口封装一个MySQLDB类，用来做项目的持久化层，存储数据，建库建表，增删改查等业务。"><a href="#使用mysql提供的API接口封装一个MySQLDB类，用来做项目的持久化层，存储数据，建库建表，增删改查等业务。" class="headerlink" title="使用mysql提供的API接口封装一个MySQLDB类，用来做项目的持久化层，存储数据，建库建表，增删改查等业务。"></a>使用mysql提供的API接口封装一个MySQLDB类，用来做项目的持久化层，存储数据，建库建表，增删改查等业务。</h4><p>mysql业务代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mysql.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;public.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;logger.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MySQLDB::Connect</span><span class="params">(<span class="type">const</span> std::string &amp;ip, <span class="type">unsigned</span> <span class="type">short</span> port,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> std::string &amp;user, <span class="type">const</span> std::string &amp;password,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> std::string &amp;db)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_mySqlClient = <span class="built_in">mysql_init</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="comment">// 三次握手 认证 鉴权  xxx  四次挥手  10s  1s</span></span><br><span class="line">    <span class="comment">// 连接池  初始连接量 最大连接量  最大的等待时间(空闲时间)10s</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">mysql_real_connect</span>(m_mySqlClient,</span><br><span class="line">        ip.<span class="built_in">c_str</span>(), user.<span class="built_in">c_str</span>(), password.<span class="built_in">c_str</span>(),</span><br><span class="line">         db.<span class="built_in">c_str</span>(), <span class="number">3306</span>, <span class="literal">nullptr</span>, <span class="number">0</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_ERROR &lt;&lt; <span class="string">&quot;mysql_real_connect() failed!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    LOG_INFO &lt;&lt; <span class="string">&quot;mysql connect success!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// snprintf /  stringstream</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">MySQLDB::Query</span><span class="params">(std::string &amp;&amp;sql)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// return value</span></span><br><span class="line">    LOG_INFO &lt;&lt; <span class="string">&quot;sql:&quot;</span> &lt;&lt; sql;</span><br><span class="line">    <span class="comment">// 执行成功返回0</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">mysql_query</span>(m_mySqlClient, sql.<span class="built_in">c_str</span>()))</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_ERROR &lt;&lt; <span class="built_in">mysql_error</span>(m_mySqlClient);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mysql_num_rows</span>(<span class="built_in">mysql_store_result</span>(m_mySqlClient));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">MySQLDB::Insert</span><span class="params">(std::string &amp;&amp;sql)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// return value</span></span><br><span class="line">    LOG_INFO &lt;&lt; <span class="string">&quot;sql:&quot;</span> &lt;&lt; sql;</span><br><span class="line">    <span class="comment">// 执行成功返回0</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">mysql_query</span>(m_mySqlClient, sql.<span class="built_in">c_str</span>()))</span><br><span class="line">    &#123;</span><br><span class="line">        LOG_ERROR &lt;&lt; <span class="built_in">mysql_error</span>(m_mySqlClient);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MySQLDB::~<span class="built_in">MySQLDB</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_mySqlClient != <span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">mysql_close</span>(m_mySqlClient);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    MySQLDB* m = MySQLDB::<span class="built_in">GetInstance</span>();</span><br><span class="line">    m-&gt;<span class="built_in">Connect</span>(MYSQL_IP, yj::MYSQLDB_PORT, USER, PASSWORD, DB);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// // snprintf   sstrem</span></span><br><span class="line">    <span class="comment">// char sql[LARGE_BUF_LEN] = &#123;0&#125;;</span></span><br><span class="line">    std::string name = <span class="string">&quot;xcg&quot;</span>;</span><br><span class="line">    std::string password = <span class="string">&quot;345&quot;</span>;</span><br><span class="line"></span><br><span class="line">    std::stringstream ss;</span><br><span class="line">    ss &lt;&lt; <span class="string">&quot;select * from user where name=\&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;\&quot; and password=\&quot;&quot;</span> &lt;&lt; password &lt;&lt; <span class="string">&quot;\&quot; limit 1;&quot;</span>;</span><br><span class="line">    <span class="comment">// snprintf(sql, LARGE_BUF_LEN, &quot;select * from user where name = %s and password = %s&quot;, name.c_str(), password.c_str());</span></span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; m-&gt;<span class="built_in">Query</span>(std::<span class="built_in">move</span>(ss.<span class="built_in">str</span>())) &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em><strong><u>遇到问题：在编译时mysql、mysql.h文件找到到，无法调用mysql的接口文件，在经过查询之后，发现是因为找不到相应的头文件，所以无法调用API，然后我将声明改成了绝对路径，程序成功通过编译生成可执行程序。</u></strong></em></p>
<p><em><strong><u>以后遇到类似问题也可以以此种方法尝试解决。</u></strong></em></p>
<p>安装Redis和docker：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">##docker</span></span></span><br><span class="line">sudo apt-get install manpages-posix manpages-posix-dev</span><br><span class="line">apt install docker-ce docker-ce-cli</span><br><span class="line">docker command</span><br><span class="line">docker exec -it 33b59573a334 /bin/bashmysql -uroot -p</span><br><span class="line">I</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">##redis 在root下进行</span></span></span><br><span class="line">- wget https://github.com/redis/hiredis/archive/refs/tags/v1.0.2.tar-gz</span><br><span class="line">- tar -zxvf v1.0.2.tar-gz- cd xxx</span><br><span class="line">- make hiredis-1.0.2 </span><br><span class="line">- make install</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>负载均衡：</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220804115232333.png" alt="image-20220804115232333"></p>
<p>nginx负载均衡组件，内部含有多种负载均衡算法。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## redis的镜像及容器的安装部署</span></span></span><br><span class="line">docker pull redis</span><br><span class="line">docker run --name dsf-redis -d redis =&gt; 容器</span><br><span class="line">docker exec -it 上一步产生的容器id /bin/bash</span><br><span class="line">redis-cli -h 127.0.0.1 -p 6379</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## mysql的镜像及容器的安装部署</span></span></span><br><span class="line">docker pull mysql:5.7.32</span><br><span class="line">docker run --name dsf-mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=你的root密码 -d mysql:5.7.32 =&gt; 容器id</span><br><span class="line">docker exec -it 上一步产生的容器id /bin/bash</span><br><span class="line">mysql -uroot -p1234</span><br><span class="line">xxx</span><br><span class="line">xxx</span><br><span class="line">xx</span><br><span class="line">exit;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220804125113601.png" alt="image-20220804125113601"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu:18.04</span><br><span class="line">MAINTAINER lsc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编译构建开发工具</span></span><br><span class="line">RUN apt-get update --fix-missing &amp;&amp; apt-get install -y fontconfig --fix-missing -y</span><br><span class="line">RUN apt-get install wget -y</span><br><span class="line">RUN apt-get install gcc -y</span><br><span class="line">RUN apt-get install gdb -y</span><br><span class="line">RUN apt-get install g++ -y</span><br><span class="line">RUN apt-get install make -y</span><br><span class="line">RUN apt-get install vim -y</span><br><span class="line">RUN apt-get install cmake -y</span><br><span class="line">RUN apt-get install git -y</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysql&amp;redis的中间件  mysql-server redis-server</span></span><br><span class="line">RUN apt-get install mysql-server -y</span><br><span class="line">RUN apt-get install redis  -y</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">libevent&amp;redis&amp;mysql的头文件以及动态库</span></span><br><span class="line">RUN apt-get install libmysqlclient-dev -y</span><br><span class="line">RUN apt-get install libevent-dev -y</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、redis的api和so</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RUN wget https://github.com/redis/hiredis/archive/refs/tags/v1.0.2.tar.gz</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RUN tar -zxvf v1.0.2.tar.gz</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RUN <span class="built_in">cd</span> hiredis-1.0.2</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RUN make</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RUN make install</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、git下载不了代码  ssh的私钥配置的有问题  git <span class="built_in">clone</span> dsf的代码</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">WORKDIR /tmp</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">COPY id_rsa .</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RUN git <span class="built_in">clone</span> git@gitee.com:lexingsen/dsf-lsc.git</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/29/Linux%E9%A1%B9%E7%9B%AE-lsc/" data-id="cllwbvs7q0008d4mo720636a9" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/08/29/Linux%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2023/08/29/K%E4%B8%AA%E4%B8%80%E7%BB%84%E7%BF%BB%E8%BD%AC%E9%93%BE%E8%A1%A8/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/08/29/%E9%87%8D%E8%BD%BD%E5%87%BD%E6%95%B0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/08/29/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/08/29/%E6%97%A9%E6%9C%9F%E7%B3%BB%E7%BB%9F%E9%87%87%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9D%A5%E7%AE%A1%E7%90%86%E5%92%8C%E5%AD%98%E6%94%BE%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%BD%86%E9%9A%8F%E7%9D%80%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E7%9A%84%E5%85%B4%E8%B5%B7%EF%BC%8C%E5%A4%A7%E5%AE%B6%E6%83%B3%E8%A6%81%E9%80%9A%E8%BF%87%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E6%9D%A5%E6%89%BE%E5%88%B0%E6%95%B0%E6%8D%AE%E4%B9%8B%E9%97%B4%E5%8F%AF%E8%83%BD%E5%AD%98%E5%9C%A8%E7%9A%84%E5%85%B3%E7%B3%BB%EF%BC%8C%E6%89%80%E4%BB%A5%E5%A4%A7%E5%AE%B6%E8%AE%BE%E8%AE%A1%E4%BA%86%E4%B8%80%E5%A5%97%E6%96%B0%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%8C%E6%8A%8A%E6%89%80%E6%9C%89%E7%9A%84%E6%95%B0%E6%8D%AE%E5%85%A8%E9%83%A8%E5%AD%98%E5%82%A8%E5%88%B0%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%EF%BC%8C%E7%84%B6%E5%90%8E%E7%BB%9F%E4%B8%80%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%EF%BC%8C%E8%BF%99%E4%B8%AA%E7%B3%BB%E7%BB%9F%E5%8F%AB%E5%81%9A%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E3%80%82/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/08/29/%E5%BC%95%E7%94%A8%E3%80%81%E6%8C%87%E9%92%88%E5%92%8Cconst%E7%9A%84%E5%85%B3%E7%B3%BB/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/08/29/%E5%8D%8F%E5%90%8C%E8%BF%87%E6%BB%A4%E7%AE%97%E6%B3%95%E7%9A%84%E5%88%86%E7%B1%BB%EF%BC%9A/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>